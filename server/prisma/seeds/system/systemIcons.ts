import { PrismaClient, SystemIcon } from '@prisma/client';

// Helper to make SVG strings more manageable by removing newlines and excessive whitespace.
// This is optional but can make the SVG strings in the data array cleaner.
const formatSvg = (svgString: string): string => {
  return svgString.replace(/\\n/g, "").replace(/\\s+/g, " ").replace(/>\\s+</g, "><").trim();
};

// Define the data for the system icons.
// ID will be auto-generated by Prisma (@default(cuid())).
// We will upsert based on the unique `name` field.
export const systemIconSeedData: Omit<SystemIcon, 'id' | 'createdAt' | 'updatedAt' | 'asset'>[] = [
  {
    name: 'Filled Circle',
    category: 'Basic Shapes',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Twitter: https://github.com/twitter/twemoji -->
      <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet">
        <circle fill="currentColor" cx="18" cy="18" r="18"></circle>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A simple filled circle.',
    tags: ['shape', 'basic', 'dot', 'round'],
  },
  {
    name: 'Heart Suit',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Twitter: https://github.com/twitter/twemoji -->
      <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet">
        <path fill="currentColor" d="M2.067 11.319C2.067 2.521 14.251-.74 18 9.445C21.749-.741 33.933 2.52 33.933 11.319C33.933 20.879 18 33 18 33S2.067 20.879 2.067 11.319z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A classic heart shape, like a card suit.',
    tags: ['heart', 'love', 'symbol', 'card'],
  },
  {
    name: 'Filled Heart',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Twitter: https://github.com/twitter/twemoji -->
      <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet">
        <path fill="currentColor" d="M35.885 11.833c0-5.45-4.418-9.868-9.867-9.868c-3.308 0-6.227 1.633-8.018 4.129c-1.791-2.496-4.71-4.129-8.017-4.129c-5.45 0-9.868 4.417-9.868 9.868c0 .772.098 1.52.266 2.241C1.751 22.587 11.216 31.568 18 34.034c6.783-2.466 16.249-11.447 17.617-19.959c.17-.721.268-1.469.268-2.242z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A solid, filled heart. Color will be applied dynamically.',
    tags: ['heart', 'love', 'symbol', 'filled'],
  },
  {
    name: 'Glowing Star',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Twitter: https://github.com/twitter/twemoji -->
      <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet">
        <path fill="currentColor" d="M28.84 17.638c-.987 1.044-1.633 3.067-1.438 4.493l.892 6.441c.197 1.427-.701 2.087-1.996 1.469l-5.851-2.796c-1.295-.62-3.408-.611-4.7.018l-5.826 2.842c-1.291.629-2.193-.026-2.007-1.452l.843-6.449c.186-1.427-.475-3.444-1.47-4.481l-4.494-4.688c-.996-1.037-.655-2.102.755-2.365l6.37-1.188c1.41-.263 3.116-1.518 3.793-2.789L16.762.956c.675-1.271 1.789-1.274 2.473-.009L22.33 6.66c.686 1.265 2.4 2.507 3.814 2.758l6.378 1.141c1.412.252 1.761 1.314.774 2.359l-4.456 4.72z"></path>
        <path fill="currentColor" d="M9.783 2.181c1.023 1.413 2.446 4.917 1.717 5.447c-.728.531-3.607-1.91-4.63-3.323c-1.022-1.413-.935-2.668-.131-3.254c.804-.587 2.02-.282 3.044 1.13zm19.348 2.124C28.109 5.718 25.23 8.16 24.5 7.627c-.729-.53.695-4.033 1.719-5.445C27.242.768 28.457.463 29.262 1.051c.803.586.89 1.841-.131 3.254zM16.625 33.291c-.001-1.746.898-5.421 1.801-5.421c.897 0 1.798 3.675 1.797 5.42c0 1.747-.804 2.712-1.8 2.71c-.994.002-1.798-.962-1.798-2.709zm16.179-9.262c-1.655-.539-4.858-2.533-4.579-3.395c.277-.858 4.037-.581 5.69-.041c1.655.54 2.321 1.605 2.013 2.556c-.308.95-1.469 1.42-3.124.88zM2.083 20.594c1.655-.54 5.414-.817 5.694.044c.276.857-2.928 2.854-4.581 3.392c-1.654.54-2.818.07-3.123-.88c-.308-.95.354-2.015 2.01-2.556z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A star with glowing points.',
    tags: ['star', 'glow', 'achievement', 'rating'],
  },
  {
    name: 'Simple Star',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Twitter: https://github.com/twitter/twemoji -->
      <svg viewBox="0 0 36 36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--twemoji" preserveAspectRatio="xMidYMid meet">
        <path fill="currentColor" d="M27.287 34.627c-.404 0-.806-.124-1.152-.371L18 28.422l-8.135 5.834a1.97 1.97 0 0 1-2.312-.008a1.971 1.971 0 0 1-.721-2.194l3.034-9.792l-8.062-5.681a1.98 1.98 0 0 1-.708-2.203a1.978 1.978 0 0 1 1.866-1.363L12.947 13l3.179-9.549a1.976 1.976 0 0 1 3.749 0L23 13l10.036.015a1.975 1.975 0 0 1 1.159 3.566l-8.062 5.681l3.034 9.792a1.97 1.97 0 0 1-.72 2.194a1.957 1.957 0 0 1-1.16.379z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A standard five-pointed star.',
    tags: ['star', 'favorite', 'rating', 'achievement'],
  },
  {
    name: 'Shield',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by Sargam Icons: https://github.com/planetabhi/sargam-icons -->
      <svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M12.113 21.98a.333.333 0 0 1-.226 0C10.917 21.64 4 18.94 4 11.252V4.304a.4.4 0 0 1 .303-.389l7.6-1.903a.4.4 0 0 1 .194 0l7.6 1.903a.4.4 0 0 1 .303.389v6.948c0 7.765-6.916 10.397-7.887 10.729Z" fill="currentColor"/>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A protective shield symbol.',
    tags: ['shield', 'protection', 'security', 'defense'],
  },
  {
    name: 'Crossed Swords',
    category: 'Symbols',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: GPL. Made by nagoshiashumari: https://github.com/nagoshiashumari/Rpg-Awesome -->
      <svg fill="currentColor" width="800px" height="800px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg">
        <title>crossed-swords</title>
        <path d="M24.061 21.904l4.299-4.299-1.78-1.779c-0.694 1.364-1.523 2.621-2.463 3.78-1.439-1.437-2.855-2.843-4.271-4.213 4.169-4.433 7.942-9.042 10.831-14.491-5.538 3.087-10.224 6.757-14.722 10.836-4.498-4.079-9.184-7.749-14.722-10.836 2.889 5.449 6.662 10.059 10.831 14.491-1.416 1.37-2.833 2.776-4.271 4.213-0.94-1.159-1.769-2.416-2.463-3.78l-1.78 1.78 4.299 4.299c-1.64 2.725-3.963 4.769-6.613 6.484l1.751 1.751c1.735-2.631 3.853-4.879 6.494-6.603l4.289 4.289 1.78-1.78c-1.308-0.756-2.563-1.592-3.739-2.516 1.396-1.393 2.782-2.764 4.144-4.133 1.362 1.368 2.748 2.739 4.144 4.133-1.177 0.924-2.431 1.761-3.739 2.516l1.78 1.78 4.289-4.289c2.641 1.724 4.759 3.972 6.494 6.603l1.751-1.751c-2.65-1.716-4.973-3.759-6.613-6.484z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'Two swords crossed, symbol of conflict or battle.',
    tags: ['swords', 'battle', 'combat', 'weapon', 'rpg'],
  },
  {
    name: 'Ribbon Award',
    category: 'Awards',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by thesabbir: https://github.com/thesabbir/simple-line-icons -->
      <svg fill="currentColor" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">
        <path d="M1021.06 839.968L833.798 493.664c19.104-43.36 29.792-91.28 29.792-141.696C863.59 157.664 706.07.16 511.782.16c-194.336 0-351.84 157.52-351.84 351.808 0 51.632 11.216 100.624 31.184 144.784L3.03 839.808c-6.065 11.024-5.057 24.624 2.527 34.688 7.6 10.033 20.432 14.752 32.687 11.873l160.624-36.848 54.976 153.12c4.288 11.904 15.152 20.16 27.744 21.088.817.064 1.6.096 2.368.096a32.002 32.002 0 0 0 28.192-16.88L475.844 701.97a355.152 355.152 0 0 0 35.92 1.808c11.12 0 22.095-.576 32.943-1.6l167.248 305.008a31.984 31.984 0 0 0 30.56 16.527c12.56-1.008 23.376-9.248 27.631-21.088l54.976-153.12 160.624 36.848c12.32 2.975 25.024-1.809 32.624-11.809 7.632-9.984 8.656-23.52 2.688-34.576zm-731.282 73.376L249.52 801.183c-5.504-15.248-21.471-24.128-37.28-20.368l-118.8 27.248L228.85 561.087c44.592 60.24 107.952 105.68 181.44 127.793zm-65.553-561.377c0-158.544 129.009-287.536 287.568-287.536 158.544 0 287.536 128.992 287.536 287.536S670.337 639.535 511.793 639.535c-158.576 0-287.568-129.024-287.568-287.568zm587.52 428.847c-15.872-3.744-31.776 5.12-37.28 20.367l-40.529 112.976-123.152-224.56c75.44-22.096 140.337-68.735 185.505-130.735L931.137 808.19z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A badge shape with a decorative ribbon.',
    tags: ['award', 'ribbon', 'prize', 'recognition', 'ceremony'],
  },
  {
    name: 'Checkmark Seal',
    category: 'Verification',
    svgContent: formatSvg(`<?xml version="1.0" encoding="utf-8"?>
      <!-- License: MIT. Made by framework7io: https://github.com/framework7io/framework7-icons -->
      <svg fill="currentColor" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg">
        <path d="M 23.6641 52.3985 C 26.6407 55.375 29.3594 55.3516 32.3126 52.3985 L 35.9219 48.8125 C 36.2969 48.4610 36.6250 48.3203 37.1172 48.3203 L 42.1797 48.3203 C 46.3749 48.3203 48.3204 46.3985 48.3204 42.1797 L 48.3204 37.1172 C 48.3204 36.625 48.4610 36.2969 48.8124 35.9219 L 52.3749 32.3125 C 55.3749 29.3594 55.3514 26.6407 52.3749 23.6641 L 48.8124 20.0547 C 48.4610 19.7031 48.3204 19.3516 48.3204 18.8829 L 48.3204 13.7969 C 48.3204 9.625 46.3985 7.6563 42.1797 7.6563 L 37.1172 7.6563 C 36.6250 7.6563 36.2969 7.5391 35.9219 7.1875 L 32.3126 3.6016 C 29.3594 .6250 26.6407 .6485 23.6641 3.6016 L 20.0547 7.1875 C 19.7032 7.5391 19.3516 7.6563 18.8828 7.6563 L 13.7969 7.6563 C 9.6016 7.6563 7.6563 9.5782 7.6563 13.7969 L 7.6563 18.8829 C 7.6563 19.3516 7.5391 19.7031 7.1876 20.0547 L 3.6016 23.6641 C .6251 26.6407 .6485 29.3594 3.6016 32.3125 L 7.1876 35.9219 C 7.5391 36.2969 7.6563 36.625 7.6563 37.1172 L 7.6563 42.1797 C 7.6563 46.3750 9.6016 48.3203 13.7969 48.3203 L 18.8828 48.3203 C 19.3516 48.3203 19.7032 48.4610 20.0547 48.8125 Z M 26.2891 49.7734 L 21.8828 45.3438 C 21.3672 44.8047 20.8282 44.5938 20.1016 44.5938 L 13.7969 44.5938 C 11.7110 44.5938 11.3828 44.2656 11.3828 42.1797 L 11.3828 35.875 C 11.3828 35.1719 11.1719 34.6329 10.6563 34.1172 L 6.2266 29.7109 C 4.7501 28.2109 4.7501 27.7891 6.2266 26.2891 L 10.6563 21.8829 C 11.1719 21.3672 11.3828 20.8282 11.3828 20.1016 L 11.3828 13.7969 C 11.3828 11.6875 11.6876 11.3829 13.7969 11.3829 L 20.1016 11.3829 C 20.8282 11.3829 21.3672 11.1953 21.8828 10.6563 L 26.2891 6.2266 C 27.7891 4.7500 28.2110 4.7500 29.7110 6.2266 L 34.1172 10.6563 C 34.6328 11.1953 35.1719 11.3829 35.8750 11.3829 L 42.1797 11.3829 C 44.2657 11.3829 44.5938 11.7109 44.5938 13.7969 L 44.5938 20.1016 C 44.5938 20.8282 44.8282 21.3672 45.3439 21.8829 L 49.7733 26.2891 C 51.2498 27.7891 51.2498 28.2109 49.7733 29.7109 L 45.3439 34.1172 C 44.8282 34.6329 44.5938 35.1719 44.5938 35.875 L 44.5938 42.1797 C 44.5938 44.2656 44.2657 44.5938 42.1797 44.5938 L 35.8750 44.5938 C 35.1719 44.5938 34.6328 44.8047 34.1172 45.3438 L 29.7110 49.7734 C 28.2110 51.2500 27.7891 51.2500 26.2891 49.7734 Z M 24.3438 39.2266 C 25.0235 39.2266 25.5391 38.9453 25.8907 38.5234 L 38.8985 20.3360 C 39.1563 19.9609 39.2969 19.5391 39.2969 19.1407 C 39.2969 18.1094 38.5001 17.2891 37.4219 17.2891 C 36.6485 17.2891 36.2266 17.5469 35.7579 18.2266 L 24.2735 34.3985 L 18.3438 27.8594 C 17.9454 27.4141 17.5001 27.2266 16.9141 27.2266 C 15.7657 27.2266 14.9454 28.0000 14.9454 29.0782 C 14.9454 29.5469 15.1094 29.9922 15.4376 30.3203 L 22.8907 38.6172 C 23.2423 38.9922 23.6876 39.2266 24.3438 39.2266 Z"></path>
      </svg>`),
    assetId: null,
    isAvailable: true,
    description: 'A seal with a checkmark, indicating verification or approval.',
    tags: ['checkmark', 'seal', 'verified', 'approved', 'success'],
  },
];

export async function seedSystemIcons(prisma: PrismaClient): Promise<void> {
  console.log('Seeding system icons...');
  let createdCount = 0;
  let updatedCount = 0;

  for (const iconData of systemIconSeedData) {
    // Upsert based on the unique `name` field, as `id` is auto-generated by @default(cuid())
    const { name, ...dataToUpsert } = iconData; // Exclude name from data for create/update sections if not needed or handle separately
    
    await prisma.systemIcon.upsert({
      where: { name: name }, 
      update: dataToUpsert, // Pass all fields except potentially name if it shouldn't be updated or is the same
      create: {
        name: name, // Explicitly set name on create
        category: dataToUpsert.category,
        svgContent: dataToUpsert.svgContent,
        assetId: dataToUpsert.assetId,
        isAvailable: dataToUpsert.isAvailable,
        description: dataToUpsert.description,
        tags: dataToUpsert.tags,
      },
    });
    // A bit tricky to know if it was created or updated with upsert directly
    // For more precise counting, you might do a findFirst then create/update conditional
  }
  // Simple count for now, can be improved if exact create/update counts are critical
  console.log(`System icons seeding finished. ${systemIconSeedData.length} icons processed (upserted).`);
} 